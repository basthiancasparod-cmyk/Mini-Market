<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ciervo Administrativo - Sistema de Gestión Empresarial</title>
    <script src="https://cdn.jsdelivr.net/npm/lucide@0.263.1/dist/umd/lucide.js"></script>
    <style>
        /* ================================
           RESET Y CONFIGURACIÓN BASE
           ================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(to bottom right, #f8fafc, #dbeafe, #e0e7ff);
            min-height: 100vh;
            color: #334155;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background: linear-gradient(to bottom right, #1a202c, #2d3748, #4a5568);
            color: #e2e8f0;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* ================================
           GLASSMORPHIC TOP BAR
           ================================ */
        .glassmorphic-bar {
            position: sticky;
            top: 0;
            z-index: 50;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            transition: background-color 0.3s, border-color 0.3s;
        }

        body.dark-mode .glassmorphic-bar {
            background: rgba(26, 32, 44, 0.7);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        /* Brand Section */
        .brand-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .brand-icon {
            position: relative;
            width: 48px;
            height: 48px;
            background: linear-gradient(to bottom right, #3b82f6, #9333ea);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.25);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .brand-icon:hover {
            transform: scale(1.05);
        }

        .brand-icon::after {
            content: '';
            position: absolute;
            top: -4px;
            right: -4px;
            width: 16px;
            height: 16px;
            background: #10b981;
            border-radius: 50%;
            border: 2px solid white;
        }

        .brand-text h1 {
            font-size: 1.25rem;
            font-weight: bold;
            background: linear-gradient(to right, #1e293b, #64748b);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }

        body.dark-mode .brand-text h1 {
            background: linear-gradient(to right, #e2e8f0, #a0aec0);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }

        .brand-text p {
            font-size: 0.875rem;
            color: #64748b;
        }

        body.dark-mode .brand-text p {
            color: #a0aec0;
        }

        /* Navigation */
        .breadcrumb-nav {
            display: none;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            padding: 0.75rem 1.5rem;
            backdrop-filter: blur(8px);
            transition: background-color 0.3s;
        }

        body.dark-mode .breadcrumb-nav {
            background: rgba(26, 32, 44, 0.5);
        }

        .breadcrumb-nav.visible {
            display: flex;
        }

        .breadcrumb-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            cursor: pointer;
            transition: color 0.2s;
        }

        body.dark-mode .breadcrumb-item {
            color: #a0aec0;
        }

        .breadcrumb-item:hover {
            color: #1e293b;
        }

        body.dark-mode .breadcrumb-item:hover {
            color: #e2e8f0;
        }

        .breadcrumb-item.active {
            color: #3b82f6;
            font-weight: 500;
        }

        .breadcrumb-separator {
            color: #cbd5e1;
            margin: 0 0.25rem;
        }

        body.dark-mode .breadcrumb-separator {
            color: #4a5568;
        }

        .back-button {
            display: none;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: rgba(255, 255, 255, 0.5);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            backdrop-filter: blur(8px);
            color: #64748b;
            text-decoration: none;
        }

        body.dark-mode .back-button {
            background: rgba(26, 32, 44, 0.5);
            color: #a0aec0;
        }

        .back-button.visible {
            display: flex;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        body.dark-mode .back-button:hover {
            background: rgba(26, 32, 44, 0.8);
        }

        /* User Controls */
        .user-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-info {
            display: none;
            align-items: center;
            gap: 0.75rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            padding: 0.5rem 0.75rem;
            backdrop-filter: blur(8px);
            transition: background-color 0.3s;
        }

        body.dark-mode .user-info {
            background: rgba(26, 32, 44, 0.5);
        }

        @media (min-width: 640px) {
            .user-info {
                display: flex;
            }
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(to bottom right, #3b82f6, #9333ea);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-text h3 {
            font-size: 0.875rem;
            font-weight: 500;
            color: #1e293b;
        }

        body.dark-mode .user-text h3 {
            color: #e2e8f0;
        }

        .user-text p {
            font-size: 0.75rem;
            color: #64748b;
        }

        body.dark-mode .user-text p {
            color: #a0aec0;
        }

        .icon-button {
            padding: 0.75rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            backdrop-filter: blur(8px);
        }

        .icon-button.notification {
            position: relative;
            background: rgba(255, 255, 255, 0.5);
        }

        body.dark-mode .icon-button.notification {
            background: rgba(26, 32, 44, 0.5);
        }

        .icon-button.notification:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        body.dark-mode .icon-button.notification:hover {
            background: rgba(26, 32, 44, 0.8);
        }

        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #ef4444;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.7rem;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
            box-shadow: 0 0 0 2px rgba(255,255,255,0.5);
        }

        .notification-panel {
            position: absolute;
            top: 60px; /* Adjust based on top bar height */
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            padding: 1rem;
        }

        body.dark-mode .notification-panel {
            background: #2d3748;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .notification-panel.show {
            display: block;
        }

        .notification-panel h4 {
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        body.dark-mode .notification-panel h4 {
            color: #e2e8f0;
        }

        .notification-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #3b82f6;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            padding-bottom: 0.25rem;
            border-bottom: 1px solid #e2e8f0;
        }

        body.dark-mode .notification-section-title {
            color: #93c5fd;
            border-bottom: 1px solid #4a5568;
        }

        .notification-item {
            padding: 0.75rem 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.875rem;
            color: #334155;
            cursor: default; /* Item no longer clickable */
        }

        body.dark-mode .notification-item {
            border-bottom: 1px solid #4a5568;
            color: #e2e8f0;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item:hover {
            background-color: #f8fafc;
        }

        body.dark-mode .notification-item:hover {
            background-color: #1a202c;
        }

        .notification-item strong {
            color: #1e293b;
        }

        body.dark-mode .notification-item strong {
            color: #e2e8f0;
        }

        .notification-item.overdue {
            color: #dc2626;
        }

        body.dark-mode .notification-item.overdue {
            color: #fca5a5;
        }

        .notification-item.pending {
            color: #f59e0b;
        }

        body.dark-mode .notification-item.pending {
            color: #fde047;
        }

        .notification-item.paid {
            color: #10b981;
        }

        body.dark-mode .notification-item.paid {
            color: #a7f3d0;
        }

        .notification-item.inventory-low {
            color: #f59e0b;
        }

        body.dark-mode .notification-item.inventory-low {
            color: #fde047;
        }

        .notification-item.inventory-empty {
            color: #dc2626;
        }

        body.dark-mode .notification-item.inventory-empty {
            color: #fca5a5;
        }

        .notification-item .date {
            font-size: 0.75rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        body.dark-mode .notification-item .date {
            color: #a0aec0;
        }

        .notification-empty {
            text-align: center;
            color: #64748b;
            padding: 1rem;
        }

        body.dark-mode .notification-empty {
            color: #a0aec0;
        }

        .icon-button.logout {
            background: rgba(254, 242, 242, 1);
        }

        body.dark-mode .icon-button.logout {
            background: rgba(128, 26, 26, 0.5);
        }

        .icon-button.logout:hover {
            background: rgba(254, 226, 226, 1);
        }

        body.dark-mode .icon-button.logout:hover {
            background: rgba(128, 26, 26, 0.8);
        }

        .icon-button.theme-toggle {
            background: rgba(255, 255, 255, 0.5);
            color: #64748b;
        }

        body.dark-mode .icon-button.theme-toggle {
            background: rgba(26, 32, 44, 0.5);
            color: #a0aec0;
        }

        .icon-button.theme-toggle:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        body.dark-mode .icon-button.theme-toggle:hover {
            background: rgba(26, 32, 44, 0.8);
        }

        /* ================================
           MODULE CONTAINER SYSTEM
           ================================ */
        .module-container {
            position: relative;
            min-height: calc(100vh - 80px);
        }

        .module-view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            min-height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(20px);
        }

        .module-view.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        .module-view.exiting {
            transform: translateX(-20px);
        }

        /* ================================
           DASHBOARD STYLES
           ================================ */
        .dashboard-content {
            padding: 2rem 0;
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 3rem;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(219, 234, 254, 1);
            color: #1d4ed8;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        body.dark-mode .badge {
            background: rgba(59, 130, 246, 0.3);
            color: #93c5fd;
        }

        .main-title, .page-title {
            font-size: 2.25rem;
            font-weight: bold;
            background: linear-gradient(to right, #1e293b, #1e40af, #7c3aed);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            margin-bottom: 1rem;
        }

        body.dark-mode .main-title, body.dark-mode .page-title {
            background: linear-gradient(to right, #e2e8f0, #93c5fd, #c4b5fd);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
        }

        .main-subtitle, .page-subtitle {
            font-size: 1.125rem;
            color: #64748b;
            max-width: 48rem;
            margin: 0 auto;
        }

        body.dark-mode .main-subtitle, body.dark-mode .page-subtitle {
            color: #a0aec0;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }

        body.dark-mode .section-title {
            color: #e2e8f0;
        }

        .section-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
        }

        body.dark-mode .section-meta {
            color: #a0aec0;
        }

        .main-modules {
            margin-bottom: 3rem;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .modules-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .modules-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .module-card {
            position: relative;
            background: white;
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.dark-mode .module-card {
            background: #2d3748;
            border: 1px solid #4a5568;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .module-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        body.dark-mode .module-card:hover {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .module-card.active {
            ring: 2px solid #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .module-gradient {
            position: absolute;
            inset: 0;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .module-card:hover .module-gradient {
            opacity: 0.05;
        }

        .gradient-emerald {
            background: linear-gradient(to bottom right, #34d399, #14b8a6, #06b6d4);
        }

        .gradient-blue {
            background: linear-gradient(to bottom right, #60a5fa, #6366f1, #a855f7);
        }

        .gradient-violet {
            background: linear-gradient(to bottom right, #a78bfa, #8b5cf6, #6366f1);
        }

        .module-content {
            position: relative;
            z-index: 10;
        }

        .module-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .module-icon {
            padding: 1rem;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        body.dark-mode .module-icon {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .module-card:hover .module-icon {
            transform: scale(1.1);
        }

        .icon-emerald {
            background: linear-gradient(to bottom right, #34d399, #14b8a6, #06b6d4);
        }

        .icon-blue {
            background: linear-gradient(to bottom right, #60a5fa, #6366f1, #a855f7);
        }

        .icon-violet {
            background: linear-gradient(to bottom right, #a78bfa, #8b5cf6, #6366f1);
        }

        .arrow-icon {
            color: #94a3b8;
            transition: all 0.3s;
        }

        body.dark-mode .arrow-icon {
            color: #a0aec0;
        }

        .module-card:hover .arrow-icon {
            color: #64748b;
        }

        body.dark-mode .module-card:hover .arrow-icon {
            color: #cbd5e1;
        }

        .module-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 0.5rem;
            transition: color 0.3s;
        }

        body.dark-mode .module-title {
            color: #e2e8f0;
        }

        .module-card:hover .module-title {
            color: #0f172a;
        }

        body.dark-mode .module-card:hover .module-title {
            color: #f8fafc;
        }

        .module-description {
            color: #64748b;
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        body.dark-mode .module-description {
            color: #a0aec0;
        }

        .module-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
        }

        .status-text {
            font-size: 0.75rem;
            color: #64748b;
            font-weight: 500;
        }

        body.dark-mode .status-text {
            color: #a0aec0;
        }

        .hover-text {
            font-size: 0.75rem;
            font-weight: 600;
            color: #2563eb;
            opacity: 0;
            transition: opacity 0.3s;
        }

        body.dark-mode .hover-text {
            color: #93c5fd;
        }

        .module-card:hover .hover-text {
            opacity: 1;
        }

        .secondary-modules {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        @media (min-width: 1024px) {
            .secondary-modules {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .secondary-section h4 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
        }

        body.dark-mode .secondary-section h4 {
            color: #e2e8f0;
        }

        .secondary-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .secondary-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
        }

        body.dark-mode .secondary-item {
            background: #2d3748;
            border: 1px solid #4a5568;
        }

        .secondary-item:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .secondary-item:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .secondary-icon {
            padding: 0.75rem;
            border-radius: 12px;
            transition: transform 0.2s;
        }

        .secondary-item:hover .secondary-icon {
            transform: scale(1.05);
        }

        .secondary-info {
            flex: 1;
        }

        .secondary-title {
            font-weight: 600;
            color: #1e293b;
        }

        body.dark-mode .secondary-title {
            color: #e2e8f0;
        }

        .secondary-subtitle {
            font-size: 0.875rem;
            color: #64748b;
        }

        body.dark-mode .secondary-subtitle {
            color: #a0aec0;
        }

        .chevron {
            color: #94a3b8;
            transition: color 0.2s;
        }

        body.dark-mode .chevron {
            color: #a0aec0;
        }

        .secondary-item:hover .chevron {
            color: #64748b;
        }

        body.dark-mode .secondary-item:hover .chevron {
            color: #cbd5e1;
        }

        .secondary-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none; /* Disable clicks */
        }

        /* ================================
           INVENTORY MODULE STYLES
           ================================ */
        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .action-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .search-container {
            position: relative;
            flex: 1;
            min-width: 250px;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            backdrop-filter: blur(8px);
            transition: all 0.2s;
            color: #1e293b;
        }

        body.dark-mode .search-input {
            background: rgba(26, 32, 44, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.9);
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        body.dark-mode .search-input:focus {
            background: rgba(26, 32, 44, 0.9);
            border-color: #93c5fd;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }

        body.dark-mode .search-icon {
            color: #a0aec0;
        }

        .action-buttons {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(to right, #3b82f6, #6366f1);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.7);
            color: #64748b;
            backdrop-filter: blur(8px);
        }

        body.dark-mode .btn-secondary {
            background: rgba(26, 32, 44, 0.7);
            color: #a0aec0;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        body.dark-mode .btn-secondary:hover {
            background: rgba(26, 32, 44, 0.9);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
        }

        body.dark-mode .stat-card {
            background: #2d3748;
            border: 1px solid #4a5568;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .stat-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-icon {
            padding: 0.75rem;
            border-radius: 12px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }

        body.dark-mode .stat-value {
            color: #e2e8f0;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-top: 0.25rem;
        }

        body.dark-mode .stat-label {
            color: #a0aec0;
        }

        .stat-change {
            font-size: 0.75rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: #059669;
        }

        .stat-change.negative {
            color: #dc2626;
        }

        .inventory-container {
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        body.dark-mode .inventory-container {
            background: #2d3748;
            border: 1px solid #4a5568;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.3);
        }

        .inventory-header {
            padding: 2rem;
            border-bottom: 1px solid #e2e8f0;
            background: linear-gradient(to right, #f8fafc, #f1f5f9);
        }

        body.dark-mode .inventory-header {
            border-bottom: 1px solid #4a5568;
            background: linear-gradient(to right, #1a202c, #2d3748);
        }

        .inventory-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        body.dark-mode .inventory-title {
            color: #e2e8f0;
        }

        .inventory-subtitle {
            color: #64748b;
        }

        body.dark-mode .inventory-subtitle {
            color: #a0aec0;
        }

        .table-container {
            overflow-x: auto;
        }

        .inventory-table {
            width: 100%;
            border-collapse: collapse;
        }

        .inventory-table th {
            background: #f8fafc;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e2e8f0;
            white-space: nowrap;
        }

        body.dark-mode .inventory-table th {
            background: #1a202c;
            color: #e2e8f0;
            border-bottom: 1px solid #4a5568;
        }

        .inventory-table td {
            padding: 1rem;
            border-bottom: 1px solid #f1f5f9;
            vertical-align: middle;
        }

        body.dark-mode .inventory-table td {
            border-bottom: 1px solid #4a5568;
        }

        .inventory-table tbody tr:hover {
            background: #f8fafc;
        }

        body.dark-mode .inventory-table tbody tr:hover {
            background: #1a202c;
        }

        .product-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .product-image {
            width: 40px;
            height: 40px;
            background: linear-gradient(to bottom right, #dbeafe, #e0e7ff);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3b82f6;
        }

        body.dark-mode .product-image {
            background: linear-gradient(to bottom right, #4a5568, #2d3748);
            color: #93c5fd;
        }

        .product-details h4 {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        body.dark-mode .product-details h4 {
            color: #e2e8f0;
        }

        .product-details p {
            font-size: 0.875rem;
            color: #64748b;
        }

        body.dark-mode .product-details p {
            color: #a0aec0;
        }

        .stock-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .stock-high {
            background: #dcfce7;
            color: #166534;
        }

        body.dark-mode .stock-high {
            background: #14532d;
            color: #a7f3d0;
        }

        .stock-medium {
            background: #fef3c7;
            color: #92400e;
        }

        body.dark-mode .stock-medium {
            background: #78350f;
            color: #fde68a;
        }

        .stock-low {
            background: #fee2e2;
            color: #991b1b;
        }

        body.dark-mode .stock-low {
            background: #991b1b;
            color: #fca5a5;
        }

        .price-cell {
            text-align: right;
        }

        .price-main {
            font-weight: 600;
            color: #1e293b;
        }

        body.dark-mode .price-main {
            color: #e2e8f0;
        }

        .price-cost {
            font-size: 0.875rem;
            color: #64748b;
        }

        body.dark-mode .price-cost {
            color: #a0aec0;
        }

        .margin-cell {
            text-align: center;
        }

        .margin-value {
            font-weight: 600;
            color: #059669;
        }

        body.dark-mode .margin-value {
            color: #a7f3d0;
        }

        .action-buttons-cell {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn-icon {
            padding: 0.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-edit {
            background: #dbeafe;
            color: #2563eb;
        }

        body.dark-mode .btn-edit {
            background: #4a5568;
            color: #93c5fd;
        }

        .btn-edit:hover {
            background: #bfdbfe;
        }

        body.dark-mode .btn-edit:hover {
            background: #64748b;
        }

        .btn-delete {
            background: #fee2e2;
            color: #dc2626;
        }

        body.dark-mode .btn-delete {
            background: #7f1d1d;
            color: #fca5a5;
        }

        .btn-delete:hover {
            background: #fecaca;
        }

        body.dark-mode .btn-delete:hover {
            background: #991b1b;
        }

        /* ================================
           MODAL STYLES
           ================================ */
        .modal {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        body.dark-mode .modal-content {
            background: #2d3748;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            padding: 2rem 2rem 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }

        body.dark-mode .modal-title {
            color: #e2e8f0;
        }

        .close-button {
            padding: 0.5rem;
            border: none;
            background: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .close-button:hover {
            background: #f1f5f9;
        }

        body.dark-mode .close-button:hover {
            background: #4a5568;
        }

        .modal-body {
            padding: 2rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }

        body.dark-mode .form-label {
            color: #e2e8f0;
        }

        .form-input, .form-select, .form-textarea {
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 0.875rem;
            background: white;
            color: #1e293b;
        }

        body.dark-mode .form-input, body.dark-mode .form-select, body.dark-mode .form-textarea {
            background: #1a202c;
            border: 1px solid #4a5568;
            color: #e2e8f0;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        body.dark-mode .form-input:focus, body.dark-mode .form-select:focus, body.dark-mode .form-textarea:focus {
            border-color: #93c5fd;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .calculated-field {
            background: #f8fafc;
            border-color: #e2e8f0;
            color: #64748b;
            cursor: not-allowed;
        }

        body.dark-mode .calculated-field {
            background: #4a5568;
            border-color: #64748b;
            color: #a0aec0;
        }

        .modal-footer {
            padding: 0 2rem 2rem 2rem;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .btn-cancel {
            background: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        body.dark-mode .btn-cancel {
            background: #4a5568;
            color: #e2e8f0;
            border: 1px solid #64748b;
        }

        .btn-cancel:hover {
            background: #f1f5f9;
        }

        body.dark-mode .btn-cancel:hover {
            background: #64748b;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #64748b;
        }

        body.dark-mode .empty-state {
            color: #a0aec0;
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            background: #f1f5f9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: #94a3b8;
        }

        body.dark-mode .empty-state-icon {
            background: #4a5568;
            color: #a0aec0;
        }

        /* ================================
           SYNC STATUS INDICATOR
           ================================ */
        .sync-indicator {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #64748b;
            z-index: 30;
        }

        body.dark-mode .sync-indicator {
            background: #2d3748;
            border: 1px solid #4a5568;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            color: #a0aec0;
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ================================
           LOADING OVERLAY
           ================================ */
        .loading-overlay {
            position: fixed;
            inset: 0;
            z-index: 999;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
        }

        body.dark-mode .loading-overlay {
            background: rgba(26, 32, 44, 0.9);
        }

        .loading-overlay.visible {
            display: flex;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        body.dark-mode .loading-spinner {
            border: 3px solid #4a5568;
            border-top: 3px solid #93c5fd;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ================================
           RESPONSIVE DESIGN
           ================================ */
        @media (max-width: 767px) {
            .main-title, .page-title {
                font-size: 1.875rem;
            }

            .modules-grid {
                gap: 1rem;
            }

            .module-card {
                padding: 1.5rem;
            }

            .secondary-modules {
                gap: 1.5rem;
            }

            .action-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-container {
                min-width: auto;
            }

            .action-buttons {
                justify-content: center;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .inventory-table {
                font-size: 0.875rem;
            }

            .inventory-table th,
            .inventory-table td {
                padding: 0.75rem 0.5rem;
            }

            .product-info {
                flex-direction: column;
                text-align: center;
            }

            .action-buttons-cell {
                flex-direction: column;
            }

            .modal-content {
                margin: 1rem;
                width: calc(100% - 2rem);
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Estilos adicionales para el modal de operaciones */
        .operations-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .operations-modal.active {
            display: flex;
        }

        .operations-modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.06);
        }

        body.dark-mode .operations-modal-content {
            background: #2d3748;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            background: linear-gradient(to right, #059669, #047857);
            color: white;
            border-radius: 12px 12px 0 0;
        }

        body.dark-mode .modal-header {
            border-bottom: 1px solid #4a5568;
            background: linear-gradient(to right, #14532d, #10b981);
        }

        .modal-title-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .modal-icon {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }

        .modal-subtitle {
            margin: 0;
            opacity: 0.9;
            font-size: 0.875rem;
        }

        .close-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .operations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .operation-card {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        body.dark-mode .operation-card {
            background: #2d3748;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .operation-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body.dark-mode .operation-card:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }

        .operation-gradient {
            height: 4px;
            width: 100%;
        }

        .gradient-blue {
            background: linear-gradient(to right, #3b82f6, #2563eb);
        }

        .gradient-emerald {
            background: linear-gradient(to right, #10b981, #059669);
        }

        .operation-content {
            padding: 1.5rem;
        }

        .operation-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .operation-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 12px;
        }

        .icon-blue {
            background: linear-gradient(to bottom right, #3b82f6, #2563eb);
        }

        .icon-emerald {
            background: linear-gradient(to bottom right, #10b981, #059669);
        }

        .arrow-icon {
            color: #9ca3af;
        }

        body.dark-mode .arrow-icon {
            color: #a0aec0;
        }

        .operation-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
            color: #1f2937;
        }

        body.dark-mode .operation-title {
            color: #e2e8f0;
        }

        .operation-description {
            margin: 0 0 1rem 0;
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        body.dark-mode .operation-description {
            color: #a0aec0;
        }

        .operation-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #10b981;
        }

        .status-text {
            font-size: 0.75rem;
            color: #6b7280;
        }

        body.dark-mode .status-text {
            color: #a0aec0;
        }

        .hover-text {
            font-size: 0.75rem;
            color: #9ca3af;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        body.dark-mode .hover-text {
            color: #a0aec0;
        }

        .operation-card:hover .hover-text {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Top Bar -->
    <div class="glassmorphic-bar">
        <div class="container">
            <div class="top-bar">
                <!-- Brand Section -->
                <div class="brand-section">
                    <div class="brand-icon" onclick="navigateToModule('dashboard')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2-2v18Z"/>
                            <path d="M6 12H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2"/>
                            <path d="M18 9h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2"/>
                            <path d="M10 6h4"/>
                            <path d="M10 10h4"/>
                            <path d="M10 14h4"/>
                            <path d="M10 18h4"/>
                        </svg>
                    </div>
                    <div class="brand-text">
                        <h1>Ciervo Administrativo</h1>
                        <p>Sistema de Gestión Empresarial</p>
                    </div>
                </div>

                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav" id="breadcrumbNav">
                    <div class="breadcrumb-item" onclick="navigateToModule('dashboard')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        </svg>
                        <span>Dashboard</span>
                    </div>
                    <span class="breadcrumb-separator" id="breadcrumbSeparator" style="display: none;">/</span>
                    <div class="breadcrumb-item active" id="currentModule" style="display: none;">
                        <span id="currentModuleName"></span>
                    </div>
                </div>

                <!-- Back Button -->
                <button class="back-button" id="backButton" onclick="navigateToModule('dashboard')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 12H6m0 0l6 6m-6-6l6-6"/>
                    </svg>
                    <span>Volver al Dashboard</span>
                </button>

                <!-- User Controls -->
                <div class="user-controls">
                    <div class="user-info">
                        <div class="user-avatar">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div class="user-text">
                            <h3 id="user-name">Administrador</h3>
                            <p id="user-role">Sesión activa</p>
                        </div>
                    </div>
                    <button class="icon-button notification" onclick="toggleNotifications()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
                        </svg>
                        <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        <div class="notification-panel" id="notificationPanel">
                            <h4>Notificaciones</h4>
                            <div id="notificationList">
                                <!-- Notifications will be loaded here -->
                            </div>
                            <p class="notification-empty" id="notificationEmpty">No hay notificaciones pendientes.</p>
                        </div>
                    </button>
                    <button class="icon-button theme-toggle" onclick="toggleDarkMode()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sun-icon">
                            <circle cx="12" cy="12" r="4"/>
                            <path d="M12 2v2"/>
                            <path d="M12 20v2"/>
                            <path d="M22 12h-2"/>
                            <path d="M4 12H2"/>
                            <path d="M19.78 4.22l-1.42 1.42"/>
                            <path d="M6.44 17.56l-1.42 1.42"/>
                            <path d="M4.22 4.22l1.42 1.42"/>
                            <path d="M17.56 6.44l1.42-1.42"/>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="moon-icon" style="display: none;">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                        </svg>
                    </button>
                    <button class="icon-button logout" onclick="handleLogout()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16,17 21,12 16,7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Operaciones -->
    <div class="operations-modal" id="operationsModal">
        <div class="operations-modal-content">
            <div class="modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="8" cy="21" r="1"/>
                            <circle cx="19" cy="21" r="1"/>
                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57L20.9 9.35H4.12"/>
                        </svg>
                    </div>
                    <div>
                        <h2 class="modal-title">Operaciones</h2>
                        <p class="modal-subtitle">Selecciona el tipo de operación que deseas realizar</p>
                    </div>
                </div>
                <button class="close-button" onclick="closeOperationsModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"/>
                        <path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>

            <div class="modal-body">
                <div class="operations-grid">
                    <!-- Tarjeta Realizar Nueva Compra -->
                    <div class="operation-card" id="newPurchaseCard" onclick="window.location.href='compras.html'">
                        <div class="operation-gradient gradient-blue"></div>
                        <div class="operation-content">
                            <div class="operation-header">
                                <div class="operation-icon icon-blue">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
                                        <path d="M3 6h18"/>
                                        <path d="M16 10a4 4 0 0 1-8 0"/>
                                    </svg>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="arrow-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M7 7h10v10"/>
                                    <path d="M7 17 17 7"/>
                                </svg>
                            </div>
                            <h3 class="operation-title">Realizar Nueva Compra</h3>
                            <p class="operation-description">
                                Registra compras de productos y servicios a proveedores
                            </p>
                            <div class="operation-status">
                                <div class="status-indicator">
                                    <div class="status-dot"></div>
                                    <span class="status-text">Disponible</span>
                                </div>
                                <span class="hover-text">Hacer clic para abrir</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tarjeta Realizar Nueva Venta -->
                    <div class="operation-card" id="newSaleCard" onclick="window.location.href='mini_market_pos.html'">
                        <div class="operation-gradient gradient-emerald"></div>
                        <div class="operation-content">
                            <div class="operation-header">
                                <div class="operation-icon icon-emerald">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9 12l2 2 4-4"/>
                                        <path d="M21 12c.552 0 1-.448 1-1V5c0-.552-.448-1-1-1H3c-.552 0-1 .448-1 1v6c0 .552.448 1 1 1"/>
                                        <path d="M3 12v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                    </svg>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="arrow-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M7 7h10v10"/>
                                    <path d="M7 17 17 7"/>
                                </svg>
                            </div>
                            <h3 class="operation-title">Realizar Nueva Venta</h3>
                            <p class="operation-description">
                                Procesa ventas y genera facturas para clientes
                            </p>
                            <div class="operation-status">
                                <div class="status-indicator">
                                    <div class="status-dot"></div>
                                    <span class="status-text">Disponible</span>
                                </div>
                                <span class="hover-text">Hacer clic para abrir</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Module Container -->
    <div class="module-container" id="moduleContainer">
        <!-- Dashboard Module -->
        <div class="module-view active" id="dashboard-module">
            <div class="container dashboard-content">
                <!-- Welcome Section -->
                <div class="welcome-section">
                    <div class="badge">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.582a.5.5 0 0 1 0 .962L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0L9.937 15.5Z"/>
                        </svg>
                        <span>Panel de Control</span>
                    </div>
                    <h2 class="main-title">Dashboard Empresarial</h2>
                    <p class="main-subtitle">
                        Gestiona todos los aspectos de tu empresa desde una plataforma unificada e intuitiva
                    </p>
                </div>

                <!-- Main Modules -->
                <div class="main-modules">
                    <div class="section-header">
                        <h3 class="section-title">Módulos Principales</h3>
                        <div class="section-meta">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                            </svg>
                            <span>Acceso rápido</span>
                        </div>
                    </div>
                    <div class="modules-grid">

                        <!-- Operaciones Module -->
                        <div class="module-card" id="operacionesModuleCard" onclick="openOperationsModal()" data-module="operaciones">
                            <div class="module-gradient gradient-emerald"></div>
                            <div class="module-content">
                                <div class="module-header">
                                    <div class="module-icon icon-emerald">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57L20.9 9.35H4.12"/>
                                        </svg>
                                    </div>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="arrow-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M7 7h10v10"/>
                                        <path d="M7 17 17 7"/>
                                    </svg>
                                </div>
                                <h4 class="module-title">Operaciones</h4>
                                <p class="module-description">
                                    Gestión de ventas y transacciones diarias
                                </p>
                                <div class="module-status">
                                    <div class="status-indicator">
                                        <div class="status-dot"></div>
                                        <span class="status-text">Disponible</span>
                                    </div>
                                    <span class="hover-text">Hacer clic para abrir</span>
                                </div>
                            </div>
                        </div>

                        <!-- Inventario Module -->
                        <div class="module-card" id="inventarioModuleCard" onclick="window.location.href='inventario.html'" data-module="inventario">
                            <div class="module-gradient gradient-blue"></div>
                            <div class="module-content">
                                <div class="module-header">
                                    <div class="module-icon icon-blue">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <ellipse cx="12" cy="5" rx="9" ry="3"/>
                                            <path d="M3 5v14c0 1.66 4.03 3 9 3s9-1.34 9-3V5"/>
                                            <path d="M3 12c0 1.66 4.03 3 9 3s9-1.34 9-3"/>
                                        </svg>
                                    </div>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="arrow-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M7 7h10v10"/>
                                        <path d="M7 17 17 7"/>
                                    </svg>
                                </div>
                                <h4 class="module-title">Inventario</h4>
                                <p class="module-description">
                                    Control inteligente de stock y almacén
                                </p>
                                <div class="module-status">
                                    <div class="status-indicator">
                                        <div class="status-dot"></div>
                                        <span class="status-text">Disponible</span>
                                    </div>
                                    <span class="hover-text">Hacer clic para abrir</span>
                                </div>
                            </div>
                        </div>

                        <!-- Analytics Module -->
                        <div class="module-card" id="salesSummaryModuleCard" onclick="window.location.href='mini_market_pos_resumen.html'" data-module="mini_market_pos_resumen">
                            <div class="module-gradient gradient-violet"></div>
                            <div class="module-content">
                                <div class="module-header">
                                    <div class="module-icon icon-violet">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M3 3v18h18"/>
                                            <path d="M18 17V9"/>
                                            <path d="M13 17V5"/>
                                            <path d="M8 17v-3"/>
                                        </svg>
                                    </div>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="arrow-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M7 7h10v10"/>
                                        <path d="M7 17 17 7"/>
                                    </svg>
                                </div>
                                <h4 class="module-title">Resumen de Ventas</h4>
                                <p class="module-description">
                                    Métricas avanzadas y análisis de datos
                                </p>
                                <div class="module-status">
                                    <div class="status-indicator">
                                        <div class="status-dot"></div>
                                        <span class="status-text">Disponible</span>
                                    </div>
                                    <span class="hover-text">Hacer clic para abrir</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Secondary Modules -->
                <div class="secondary-modules">
                    <!-- Medium Priority -->
                    <div class="secondary-section">
                        <h4>Herramientas Auxiliares</h4>
                        <div class="secondary-list">
                            <div class="secondary-item" id="catalogItem" onclick="executeAction('openCatalog')">
                                <div class="secondary-icon icon-blue">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M8.5 8.5l11 11"/>
                                        <path d="M17.5 10 10 17.5"/>
                                        <circle cx="12" cy="12" r="2"/>
                                        <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"/>
                                        <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
                                        <path d="M12 21c0-1-1-3-3-3s-3 2-3 3 1 3 3 3 3-2 3-3"/>
                                        <path d="M12 3c0 1 1 3 3 3s3-2 3-3-1-3-3-3-3 2-3 3"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Catálogo</h5>
                                    <p class="secondary-subtitle">Biblioteca de productos y servicios</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>
                            <div class="secondary-item" id="userManagementItem" onclick="window.location.href='gestion_usuario.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #8b5cf6, #7c3aed, #6d28d9);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Gestión de Usuarios</h5>
                                    <p class="secondary-subtitle">Administración de usuarios y permisos</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>
                            <div class="secondary-item" id="providersItem" onclick="window.location.href='gestion_proveedores.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #fb923c, #f59e0b, #eab308);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/>
                                        <path d="M15 18H9"/>
                                        <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/>
                                        <circle cx="17" cy="18" r="2"/>
                                        <circle cx="7" cy="18" r="2"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Proveedores</h5>
                                    <p class="secondary-subtitle">Red de proveedores y socios comerciales</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>

                            <div class="secondary-item" id="accountsItem" onclick="window.location.href='cuentas.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #f472b6, #f43f5e, #ef4444);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
    <line x1="8" y1="2" x2="8" y2="22"/>
    <line x1="16" y1="2" x2="16" y2="22"/>
</svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Cuentas por Cobrar/Pagar</h5>
                                    <p class="secondary-subtitle">Estados de cuentas pendientes</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Low Priority -->
                    <div class="secondary-section">
                        <h4>Configuración Avanzada</h4>
                        <div class="secondary-list">
                            <div class="secondary-item" id="companyItem" onclick="window.location.href='gestion_empresa.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #94a3b8, #6b7280, #52525b);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2-2v18Z"/>
                                        <path d="M6 12H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2"/>
                                        <path d="M18 9h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2"/>
                                        <path d="M10 6h4"/>
                                        <path d="M10 10h4"/>
                                        <path d="M10 14h4"/>
                                        <path d="M10 18h4"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Empresa</h5>
                                    <p class="secondary-subtitle">Configuración y gestión empresarial</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>

                            <div class="secondary-item" id="priceCalculatorItem" onclick="window.location.href='calcular_precio_ven.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #4ade80, #10b981, #14b8a6);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="4" y="2" width="16" height="20" rx="2" ry="2"/>
    <line x1="8" y1="6" x2="16" y2="6"/>
    <line x1="8" y1="10" x2="8" y2="10"/>
    <line x1="12" y1="10" x2="12" y2="10"/>
    <line x1="16" y1="10" x2="16" y2="10"/>
    <line x1="8" y1="14" x2="8" y2="14"/>
    <line x1="12" y1="14" x2="12" y2="14"/>
    <line x1="16" y1="14" x2="16" y2="14"/>
    <line x1="8" y1="18" x2="8" y2="18"/>
    <line x1="12" y1="18" x2="12" y2="18"/>
    <line x1="16" y1="18" x2="16" y2="18"/>
</svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Calculadora de Precios Venezuela</h5>
                                    <p class="secondary-subtitle">Cotizaciones y tasas de cambio actualizadas</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>
				 <div class="secondary-item" id="clientsItem" onclick="window.location.href='listado_clientes.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #60a5fa, #3b82f6, #2563eb);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Listado de Clientes</h5>
                                    <p class="secondary-subtitle">Gestión de la base de datos de clientes</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>

                            <div class="secondary-item" id="configItem" onclick="window.location.href='config.html'">
                                <div class="secondary-icon" style="background: linear-gradient(to bottom right, #9ca3af, #6b7280, #52525b);">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </div>
                                <div class="secondary-info">
                                    <h5 class="secondary-title">Configuración</h5>
                                    <p class="secondary-subtitle">Personalización y ajustes del sistema</p>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M9 18l6-6-6-6"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inventario Module (Example of an integrated module) -->
        <div class="module-view" id="inventario-module">
            <div class="container dashboard-content">
                <div class="page-header">
                    <h2 class="page-title">Control de Inventario</h2>
                    <p class="page-subtitle">Gestiona tus productos, stock y movimientos de almacén.</p>
                </div>

                <div class="action-bar">
                    <div class="search-container">
                        <input type="text" id="searchInput" class="search-input" placeholder="Buscar producto por nombre o código...">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="M21 21l-4.3-4.3"/>
                        </svg>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="exportInventory()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Exportar
                        </button>
                        <button class="btn btn-primary" onclick="openModal('add')">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Nuevo Producto
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Total Productos</span>
                            <div class="stat-icon" style="background: #dbeafe; color: #3b82f6;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect width="7" height="7" x="3" y="3" rx="1"/>
                                    <rect width="7" height="7" x="14" y="3" rx="1"/>
                                    <rect width="7" height="7" x="14" y="14" rx="1"/>
                                    <rect width="7" height="7" x="3" y="14" rx="1"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="totalProducts">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Unidades en Stock</span>
                            <div class="stat-icon" style="background: #dcfce7; color: #10b981;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="totalStock">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Valor Total Inventario</span>
                            <div class="stat-icon" style="background: #fef3c7; color: #f59e0b;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M12 1v22M17 5H7l5 17V5z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="totalValue">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Stock Bajo</span>
                            <div class="stat-icon" style="background: #fee2e2; color: #ef4444;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                    <line x1="12" y1="9" x2="12" y2="13"/>
                                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="lowStock">0</div>
                    </div>
                </div>

                <div class="inventory-container">
                    <div class="inventory-header">
                        <h3 class="inventory-title">Listado de Productos</h3>
                        <p class="inventory-subtitle">Todos los productos registrados en tu inventario.</p>
                    </div>
                    <div class="table-container">
                        <table class="inventory-table">
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Stock</th>
                                    <th>Costo</th>
                                    <th>Margen</th>
                                    <th>Precio Venta</th>
                                    <th>Categoría/Marca</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <!-- Product rows will be rendered here by JavaScript -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="emptyState" style="display: none;">
                            <div class="empty-state-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                    <line x1="10" y1="9" x2="8" y2="9"/>
                                </svg>
                            </div>
                            <p>No hay productos registrados. ¡Comienza agregando uno!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Placeholder for other modules (if they were to be loaded dynamically, but now they are just links) -->
        <div class="module-view" id="operaciones-module"></div>
        <div class="module-view" id="reportes-module"></div>
        <!-- Add other module-view divs for any other modules you might want to display directly in this file -->

    </div>

    <!-- Sync Status Indicator -->
    <div class="sync-indicator" id="syncIndicator">
        <div class="sync-dot"></div>
        <span>Datos sincronizados</span>
    </div>

    <!-- Product Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Nuevo Producto</h2>
                <button class="close-button" onclick="closeModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"/>
                        <path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="productName" class="form-label">Nombre del Producto</label>
                            <input type="text" id="productName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="productCode" class="form-label">Código (Opcional)</label>
                            <input type="text" id="productCode" class="form-input">
                        </div>
                        <div class="form-group full-width">
                            <label for="productDescription" class="form-label">Descripción (Opcional)</label>
                            <textarea id="productDescription" class="form-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="productBrand" class="form-label">Marca (Opcional)</label>
                            <input type="text" id="productBrand" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="productCategory" class="form-label">Categoría (Opcional)</label>
                            <input type="text" id="productCategory" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="productStock" class="form-label">Stock Actual</label>
                            <input type="number" id="productStock" class="form-input" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="productMinStock" class="form-label">Stock Mínimo</label>
                            <input type="number" id="productMinStock" class="form-input" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="productCost" class="form-label">Costo Unitario</label>
                            <input type="number" id="productCost" class="form-input" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="productMargin" class="form-label">Margen de Ganancia (%)</label>
                            <input type="number" id="productMargin" class="form-input" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="productPrice" class="form-label">Precio de Venta</label>
                            <input type="text" id="productPrice" class="form-input calculated-field" readonly>
                        </div>
                        <div class="form-group">
                            <label for="productProfit" class="form-label">Ganancia por Unidad</label>
                            <input type="text" id="productProfit" class="form-input calculated-field" readonly>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeModal()">Cancelar</button>
                <button class="btn btn-primary" id="saveButton" onclick="saveProduct()">Guardar Producto</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirmar Eliminación</h2>
                <button class="close-button" onclick="closeDeleteModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"/>
                        <path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div style="width: 80px; height: 80px; margin: 0 auto 1.5rem; background: linear-gradient(to bottom right, #fee2e2, #fecaca); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                            <line x1="12" y1="9" x2="12" y2="13"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">¿Estás seguro?</h3>
                    <p style="color: #64748b;">Esta acción no se puede deshacer. El producto será eliminado permanentemente.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeDeleteModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmDelete()">Sí, Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmación de Cierre de Sesión -->
    <div class="modal" id="logoutModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title">Cerrar Sesión</h2>
                <button class="close-button" onclick="closeLogoutModal()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"/>
                        <path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div style="width: 80px; height: 80px; margin: 0 auto 1.5rem; background: linear-gradient(to bottom right, #fee2e2, #fecaca); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16,17 21,12 16,7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">¿Estás seguro de que deseas cerrar sesión?</h3>
                    <p style="color: #64748b;">Está por salir del sistema</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeLogoutModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="confirmLogout()">Sí, Cerrar Sesión</button>
            </div>
        </div>
    </div>

    <script>
        // ================================
        // GLOBAL SYSTEM MANAGEMENT
        // ================================

        // Global State Management System
        class CiervoSystemManager {
            constructor() {
                this.currentModule = 'dashboard';
                this.previousModule = null;
                this.dataStore = new Map();
                this.eventBus = new EventTarget();
                this.initializeSystem();
            }

            initializeSystem() {
                // Initialize shared data stores
                this.initializeDataStores();

                // Set up cross-module communication
                this.setupEventListeners();

                // Load initial data
                this.loadSystemData();

                // Initialize UI
                this.initializeUI();
            }

            initializeDataStores() {
                // Shared inventory data
                this.dataStore.set('inventory', []);

                // Shared accounts data
                this.dataStore.set('accounts', []);

                // Global metrics
                this.dataStore.set('metrics', {
                    totalSales: 12450,
                    totalCustomers: 324,
                    totalItems: 1850,
                    totalRevenue: 145320
                });

                // User settings
                this.dataStore.set('userSettings', {
                    role: 'Administrador',
                    theme: 'light',
                    language: 'es'
                });

                // Navigation history
                this.dataStore.set('navigationHistory', ['dashboard']);
            }

            setupEventListeners() {
                // Listen for data changes
                this.eventBus.addEventListener('dataUpdate', (event) => {
                    this.handleDataUpdate(event.detail);
                });

                // Listen for module changes
                this.eventBus.addEventListener('moduleChange', (event) => {
                    this.handleModuleChange(event.detail);
                });

                // Listen for sync events
                this.eventBus.addEventListener('syncRequired', (event) => {
                    this.syncData(event.detail);
                });
            }

            loadSystemData() {
                // Load inventory data
                const savedInventory = localStorage.getItem('ciervo_inventory');
                if (savedInventory) {
                    try {
                        this.dataStore.set('inventory', JSON.parse(savedInventory));
                    } catch (e) {
                        console.warn('Error loading inventory data:', e);
                        this.loadSampleInventoryData();
                    }
                } else {
                    this.loadSampleInventoryData();
                }

                // Load accounts data
                const savedAccounts = localStorage.getItem('ciervo_accounts');
                if (savedAccounts) {
                    try {
                        this.dataStore.set('accounts', JSON.parse(savedAccounts));
                    } catch (e) {
                        console.warn('Error loading accounts data:', e);
                        this.loadSampleAccountsData(); // Load sample if parsing fails
                    }
                } else {
                    this.loadSampleAccountsData(); // Load sample if no data found
                }

                // Load user settings
                const savedSettings = localStorage.getItem('ciervo_user_settings');
                if (savedSettings) {
                    try {
                        this.dataStore.set('userSettings', JSON.parse(savedSettings));
                    } catch (e) {
                        console.warn('Error loading user settings:', e);
                    }
                }

                // Override user role from sessionStorage if available
                const userData = JSON.parse(sessionStorage.getItem('currentUser'));
                if (userData && userData.role) {
                    const userSettings = this.getData('userSettings') || {};
                    userSettings.role = userData.role;
                    this.dataStore.set('userSettings', userSettings);
                }
            }

            loadSampleInventoryData() {
                const sampleData = [
                    {
                        id: 1,
                        name: 'Laptop HP Pavilion',
                        code: 'LAP-HP-001',
                        description: 'Laptop HP Pavilion 15.6" Intel Core i5, 8GB RAM, 256GB SSD',
                        brand: 'HP',
                        category: 'Electrónicos',
                        stock: 15,
                        minStock: 5,
                        cost: 580.00,
                        margin: 35,
                        price: 783.00,
                        profit: 203.00,
                        isBulk: false,
                        unit: null,
                        pricePerUnit: null,
                        costPerUnit: null,
                        profitPerUnit: null
                    },
                    {
                        id: 2,
                        name: 'Smartphone Samsung Galaxy',
                        code: 'TEL-SAM-002',
                        description: 'Samsung Galaxy A54 5G, 128GB, Cámara 50MP',
                        brand: 'Samsung',
                        category: 'Electrónicos',
                        stock: 8,
                        minStock: 3,
                        cost: 320.00,
                        margin: 40,
                        price: 448.00,
                        profit: 128.00,
                        isBulk: false,
                        unit: null,
                        pricePerUnit: null,
                        costPerUnit: null,
                        profitPerUnit: null
                    },
                    {
                        id: 3,
                        name: 'Audífonos Sony WH-1000XM4',
                        code: 'AUD-SON-003',
                        description: 'Audífonos inalámbricos con cancelación de ruido',
                        brand: 'Sony',
                        category: 'Electrónicos',
                        stock: 0, // Changed to 0 for testing 'agotado'
                        minStock: 8,
                        cost: 180.00,
                        margin: 50,
                        price: 270.00,
                        profit: 90.00,
                        isBulk: false,
                        unit: null,
                        pricePerUnit: null,
                        costPerUnit: null,
                        profitPerUnit: null
                    },
                    {
                        id: 4,
                        name: 'Camiseta Nike Dri-FIT',
                        code: 'CAM-NIK-004',
                        description: 'Camiseta deportiva de manga corta, tecnología Dri-FIT',
                        brand: 'Nike',
                        category: 'Deportes',
                        stock: 3,
                        minStock: 10,
                        cost: 25.00,
                        margin: 60,
                        price: 40.00,
                        profit: 15.00,
                        isBulk: false,
                        unit: null,
                        pricePerUnit: null,
                        costPerUnit: null,
                        profitPerUnit: null
                    },
                    {
                        id: 5,
                        name: 'Cafetera Nespresso',
                        code: 'CAF-NES-005',
                        description: 'Cafetera de cápsulas automática con espumador de leche',
                        brand: 'Nespresso',
                        category: 'Hogar',
                        stock: 12,
                        minStock: 4,
                        cost: 150.00,
                        margin: 45,
                        price: 217.50,
                        profit: 67.50,
                        isBulk: false,
                        unit: null,
                        pricePerUnit: null,
                        costPerUnit: null,
                        profitPerUnit: null
                    }
                ];

                this.dataStore.set('inventory', sampleData);
                this.saveData('inventory');
            }

            loadSampleAccountsData() {
                const today = new Date();
                const futureDate = new Date();
                futureDate.setDate(today.getDate() + 10);
                const pastDate = new Date();
                pastDate.setDate(today.getDate() - 5);

                const sampleAccounts = [
                    {
                        id: 1,
                        type: 'cobrar',
                        description: 'Venta de productos electrónicos',
                        contact: 'Cliente A',
                        amount: 1250.75,
                        dueDate: futureDate.toISOString().split('T')[0],
                        status: 'pending',
                        notes: 'Factura #2023-001'
                    },
                    {
                        id: 2,
                        type: 'pagar',
                        description: 'Compra de materia prima',
                        contact: 'Proveedor X',
                        amount: 800.00,
                        dueDate: futureDate.toISOString().split('T')[0],
                        status: 'pending',
                        notes: 'Orden de compra #PO-005'
                    },
                    {
                        id: 3,
                        type: 'cobrar',
                        description: 'Servicio de consultoría',
                        contact: 'Empresa B',
                        amount: 500.00,
                        dueDate: pastDate.toISOString().split('T')[0],
                        status: 'overdue',
                        notes: 'Pendiente de pago, enviar recordatorio'
                    },
                    {
                        id: 4,
                        type: 'pagar',
                        description: 'Alquiler de oficina',
                        contact: 'Arrendador',
                        amount: 1500.00,
                        dueDate: pastDate.toISOString().split('T')[0],
                        status: 'overdue',
                        notes: 'Pago de alquiler de Diciembre'
                    },
                    {
                        id: 5,
                        type: 'cobrar',
                        description: 'Venta de software',
                        contact: 'Cliente C',
                        amount: 300.00,
                        dueDate: new Date(today.getFullYear(), today.getMonth(), today.getDate() - 1).toISOString().split('T')[0],
                        status: 'paid',
                        notes: 'Pagado el 2023-12-01'
                    }
                ];
                this.dataStore.set('accounts', sampleAccounts);
                this.saveData('accounts');
            }

            initializeUI() {
                // Initialize Lucide icons
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }

                // Set initial module view
                this.showModule(this.currentModule);

                // Update UI with initial data
                this.updateGlobalUI();

                // Apply dark mode if saved preference is dark
                if (localStorage.getItem('darkMode') === 'enabled') {
                    document.body.classList.add('dark-mode');
                    document.querySelector('.sun-icon').style.display = 'none';
                    document.querySelector('.moon-icon').style.display = 'inline-block';
                }
            }

            handleDataUpdate(updateInfo) {
                const { store, data, source } = updateInfo;

                // Update the data store
                this.dataStore.set(store, data);

                // Save to localStorage
                this.saveData(store);

                // Sync across modules
                this.syncAcrossModules(store, data, source);

                // Update UI indicators
                this.updateSyncIndicator('synced');

                // Update UI if user settings changed
                if (store === 'userSettings') {
                    this.updateGlobalUI();
                }
                // Update notifications if accounts or inventory data changed
                if (store === 'accounts' || store === 'inventory') {
                    this.updateNotifications();
                }
            }

            handleModuleChange(moduleInfo) {
                const { from, to } = moduleInfo;

                this.previousModule = from;
                this.currentModule = to;

                // Update navigation history
                const history = this.dataStore.get('navigationHistory');
                history.push(to);
                this.dataStore.set('navigationHistory', history);

                // Update breadcrumbs
                this.updateBreadcrumbs();

                // Show the target module
                this.showModule(to);
            }

            syncAcrossModules(store, data, sourceModule) {
                // Emit sync event to all listening modules
                window.dispatchEvent(new CustomEvent('ciervoSync', {
                    detail: {
                        store,
                        data,
                        source: sourceModule,
                        timestamp: Date.now()
                    }
                }));
            }

            saveData(store) {
                const data = this.dataStore.get(store);
                if (data) {
                    localStorage.setItem(`ciervo_${store}`, JSON.stringify(data));
                }
            }

            getData(store) {
                return this.dataStore.get(store);
            }

            updateData(store, updater) {
                const currentData = this.getData(store);
                const newData = updater(currentData);

                this.eventBus.dispatchEvent(new CustomEvent('dataUpdate', {
                    detail: {
                        store,
                        data: newData,
                        source: this.currentModule
                    }
                }));

                return newData;
            }

            showModule(moduleId) {
                this.showLoadingOverlay(true);

                setTimeout(() => {
                    // Hide all modules
                    document.querySelectorAll('.module-view').forEach(view => {
                        view.classList.remove('active');
                        view.classList.add('exiting');
                    });

                    setTimeout(() => {
                        document.querySelectorAll('.module-view').forEach(view => {
                            view.classList.remove('exiting');
                        });

                        // Show target module
                        const targetModule = document.getElementById(`${moduleId}-module`);
                        if (targetModule) {
                            targetModule.classList.add('active');
                        }

                        this.updateNavigation(moduleId);
                        this.showLoadingOverlay(false);

                        // Re-initialize icons for the active module
                        if (typeof lucide !== 'undefined') {
                            lucide.createIcons();
                        }
                    }, 150);
                }, 100);
            }

            updateNavigation(moduleId) {
                const breadcrumbNav = document.getElementById('breadcrumbNav');
                const backButton = document.getElementById('backButton');
                const currentModule = document.getElementById('currentModule');
                const currentModuleName = document.getElementById('currentModuleName');
                const breadcrumbSeparator = document.getElementById('breadcrumbSeparator');

                if (moduleId === 'dashboard') {
                    breadcrumbNav?.classList.remove('visible');
                    backButton?.classList.remove('visible');
                } else {
                    breadcrumbNav?.classList.add('visible');
                    backButton?.classList.add('visible');

                    // Update module name in breadcrumb
                    const moduleNames = {
                        'inventario': 'Control de Inventario',
                        'operaciones': 'Operaciones',
                        'reportes': 'Analytics',
                        'proveedores': 'Proveedores',
                        'aplicativos': 'Herramientas',
                        'empresa': 'Empresa',
                        'configuracion': 'Configuración',
                        'cuentas': 'Cuentas por Cobrar/Pagar' // Added for accounts module
                    };

                    if (currentModuleName) {
                        currentModuleName.textContent = moduleNames[moduleId] || moduleId;
                    }
                    if (currentModule) currentModule.style.display = 'flex';
                    if (breadcrumbSeparator) breadcrumbSeparator.style.display = 'inline';
                }
            }

            updateBreadcrumbs() {
                // Implementation for breadcrumb updates
                this.updateNavigation(this.currentModule);
            }

            updateGlobalUI() {
                // Update user role display
                const userSettings = this.getData('userSettings');
                const userRoleElement = document.getElementById('user-role');
                if (userRoleElement && userSettings) {
                    userRoleElement.textContent = userSettings.role;
                }

                // Update user name from sessionStorage
                try {
                    const userData = JSON.parse(sessionStorage.getItem('currentUser'));
                    const userNameElement = document.getElementById('user-name');
                    if (userNameElement && userData) {
                        // Use firstName and lastName from userData
                        const fullName = `${userData.firstName || ''} ${userData.lastName || ''}`.trim();
                        if (fullName) {
                            userNameElement.textContent = fullName;
                        } else if (userData.name) {
                            userNameElement.textContent = userData.name;
                        }
                    }
                } catch (e) {
                    console.warn('Error loading user data from sessionStorage:', e);
                }

                // Apply role-based access control
                this.applyRoleBasedAccess();

                // Update notifications on UI load
                this.updateNotifications();
            }

            applyRoleBasedAccess() {
                const userRole = this.getData('userSettings').role;

                const allModuleCards = [
                    document.getElementById('operacionesModuleCard'),
                    document.getElementById('inventarioModuleCard'),
                    document.getElementById('salesSummaryModuleCard')
                ];

                const allSecondaryItems = [
                    document.getElementById('catalogItem'),
                    document.getElementById('userManagementItem'),
                    document.getElementById('providersItem'),
                    document.getElementById('accountsItem'),
                    document.getElementById('companyItem'),
                    document.getElementById('priceCalculatorItem'),
                    document.getElementById('configItem'),
                    document.getElementById('clientsItem') // Added clientsItem
                ];

                const allOperationCards = [
                    document.getElementById('newPurchaseCard'),
                    document.getElementById('newSaleCard')
                ];

                if (userRole === 'Vendedor') {
                    // Disable all main module cards except 'Operaciones' (which will only allow 'Realizar Nueva Venta')
                    allModuleCards.forEach(card => {
                        if (card && card.id !== 'operacionesModuleCard') {
                            card.classList.add('disabled');
                            card.onclick = null; // Remove click event
                        }
                    });

                    // Disable all secondary items
                    allSecondaryItems.forEach(item => {
                        if (item) {
                            item.classList.add('disabled');
                            item.onclick = null; // Remove click event
                        }
                    });

                    // In the operations modal, disable 'Realizar Nueva Compra'
                    if (document.getElementById('newPurchaseCard')) {
                        document.getElementById('newPurchaseCard').classList.add('disabled');
                        document.getElementById('newPurchaseCard').onclick = null;
                    }
                    // Ensure 'Realizar Nueva Venta' is enabled
                    if (document.getElementById('newSaleCard')) {
                        document.getElementById('newSaleCard').classList.remove('disabled');
                        document.getElementById('newSaleCard').onclick = () => { window.location.href='Mini_Market_POS.html'; };
                    }

                    // If the user clicks on "Operaciones" module card, ensure only "Realizar Nueva Venta" is clickable
                    const operacionesCard = document.getElementById('operacionesModuleCard');
                    if (operacionesCard) {
                        operacionesCard.onclick = () => {
                            openOperationsModal();
                            // Re-apply specific disabling within the modal if it's opened
                            if (document.getElementById('newPurchaseCard')) {
                                document.getElementById('newPurchaseCard').classList.add('disabled');
                                document.getElementById('newPurchaseCard').onclick = null;
                            }
                            if (document.getElementById('newSaleCard')) {
                                document.getElementById('newSaleCard').classList.remove('disabled');
                                document.getElementById('newSaleCard').onclick = () => { window.location.href='Mini_Market_POS.html'; };
                            }
                        };
                    }

                } else {
                    // Re-enable all for Administrator or other roles
                    allModuleCards.forEach(card => {
                        if (card) {
                            card.classList.remove('disabled');
                            // Re-assign original click handlers
                            if (card.id === 'operacionesModuleCard') card.onclick = openOperationsModal;
                            else if (card.id === 'inventarioModuleCard') card.onclick = () => { window.location.href='inventario.html'; };
                            else if (card.id === 'salesSummaryModuleCard') card.onclick = () => { window.location.href='mini_market_pos_resumen.html'; };
                        }
                    });

                    allSecondaryItems.forEach(item => {
                        if (item) {
                            item.classList.remove('disabled');
                            // Re-assign original click handlers
                            if (item.id === 'catalogItem') item.onclick = () => executeAction('openCatalog');
                            else if (item.id === 'userManagementItem') item.onclick = () => { window.location.href='gestion_usuario.html'; };
                            else if (item.id === 'providersItem') item.onclick = () => { window.location.href='gestion_proveedores.html'; };
                            else if (item.id === 'accountsItem') item.onclick = () => { window.location.href='cuentas.html'; };
                            else if (item.id === 'companyItem') item.onclick = () => { window.location.href='gestion_empresa.html'; };
                            else if (item.id === 'priceCalculatorItem') item.onclick = () => { window.location.href='calcular_precio_ven.html'; };
                            else if (item.id === 'configItem') item.onclick = () => { window.location.href='config.html'; };
                            else if (item.id === 'clientsItem') item.onclick = () => { window.location.href='listado_clientes.html'; }; // Re-assign for clientsItem
                        }
                    });

                    allOperationCards.forEach(card => {
                        if (card) {
                            card.classList.remove('disabled');
                            if (card.id === 'newPurchaseCard') card.onclick = () => { window.location.href='compras.html'; };
                            else if (card.id === 'newSaleCard') card.onclick = () => { window.location.href='Mini_Market_POS.html'; };
                        }
                    });
                }
            }


            updateNotifications() {
                const accounts = this.getData('accounts') || [];
                const inventory = this.getData('inventory') || [];
                const notificationList = document.getElementById('notificationList');
                const notificationBadge = document.getElementById('notificationBadge');
                const notificationEmpty = document.getElementById('notificationEmpty');
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalize today's date

                let totalNotificationCount = 0;
                let notificationsHtml = '';

                // --- Accounts Notifications ---
                let overdueAccounts = [];
                let dueTodayAccounts = [];

                accounts.forEach(account => {
                    const dueDate = new Date(account.dueDate);
                    dueDate.setHours(0, 0, 0, 0); // Normalize due date

                    if (account.status !== 'paid') {
                        if (dueDate < today) {
                            // Mark as overdue if not already
                            if (account.status !== 'overdue') {
                                account.status = 'overdue';
                                this.saveData('accounts'); // Save updated status
                            }
                            overdueAccounts.push(account);
                        } else if (dueDate.getTime() === today.getTime()) {
                            dueTodayAccounts.push(account);
                        }
                    }
                });

                if (overdueAccounts.length > 0) {
                    notificationsHtml += `<h5 class="notification-section-title">Cuentas Vencidas</h5>`;
                    overdueAccounts.forEach(account => {
                        totalNotificationCount++;
                        const typeText = account.type === 'cobrar' ? 'por Cobrar' : 'por Pagar';
                        notificationsHtml += `
                            <div class="notification-item overdue">
                                <strong>${account.description}</strong> (${typeText})
                                <br>
                                <span class="date">Vencida el: ${new Date(account.dueDate).toLocaleDateString('es-ES')}</span>
                                <br>
                                <span class="date">Monto: $${account.amount.toFixed(2)}</span>
                                <br>
                                <span class="date">Contacto: ${account.contact}</span>
                            </div>
                        `;
                    });
                }

                if (dueTodayAccounts.length > 0) {
                    notificationsHtml += `<h5 class="notification-section-title">Cuentas por Vencer Hoy</h5>`;
                    dueTodayAccounts.forEach(account => {
                        totalNotificationCount++;
                        const typeText = account.type === 'cobrar' ? 'por Cobrar' : 'por Pagar';
                        notificationsHtml += `
                            <div class="notification-item pending">
                                <strong>${account.description}</strong> (${typeText})
                                <br>
                                <span class="date">Vence hoy: ${new Date(account.dueDate).toLocaleDateString('es-ES')}</span>
                                <br>
                                <span class="date">Monto: $${account.amount.toFixed(2)}</span>
                                <br>
                                <span class="date">Contacto: ${account.contact}</span>
                            </div>
                        `;
                    });
                }

                // --- Inventory Notifications ---
                let lowStockProducts = [];
                let outOfStockProducts = [];

                inventory.forEach(product => {
                    if (product.stock <= 0) {
                        outOfStockProducts.push(product);
                    } else if (product.stock <= product.minStock) {
                        lowStockProducts.push(product);
                    }
                });

                if (outOfStockProducts.length > 0) {
                    notificationsHtml += `<h5 class="notification-section-title">Productos Agotados</h5>`;
                    outOfStockProducts.forEach(product => {
                        totalNotificationCount++;
                        notificationsHtml += `
                            <div class="notification-item inventory-empty">
                                <strong>${product.name}</strong>
                                <br>
                                <span class="date">Stock: Agotado</span>
                                <br>
                                <span class="date">Código: ${product.code || 'N/A'}</span>
                            </div>
                        `;
                    });
                }

                if (lowStockProducts.length > 0) {
                    notificationsHtml += `<h5 class="notification-section-title">Stock Bajo</h5>`;
                    lowStockProducts.forEach(product => {
                        totalNotificationCount++;
                        notificationsHtml += `
                            <div class="notification-item inventory-low">
                                <strong>${product.name}</strong>
                                <br>
                                <span class="date">Stock actual: ${product.stock} (Mínimo: ${product.minStock})</span>
                                <br>
                                <span class="date">Código: ${product.code || 'N/A'}</span>
                            </div>
                        `;
                    });
                }


                if (notificationList) {
                    notificationList.innerHTML = notificationsHtml;
                }

                if (totalNotificationCount > 0) {
                    if (notificationBadge) {
                        notificationBadge.textContent = totalNotificationCount;
                        notificationBadge.style.display = 'block';
                    }
                    if (notificationEmpty) notificationEmpty.style.display = 'none';
                } else {
                    if (notificationBadge) notificationBadge.style.display = 'none';
                    if (notificationEmpty) notificationEmpty.style.display = 'block';
                }
            }

            updateSyncIndicator(status) {
                const indicator = document.getElementById('syncIndicator');
                if (!indicator) return;

                const dot = indicator.querySelector('.sync-dot');
                const text = indicator.querySelector('span');

                switch (status) {
                    case 'syncing':
                        if (dot) dot.style.background = '#f59e0b';
                        if (text) text.textContent = 'Sincronizando...';
                        break;
                    case 'synced':
                        if (dot) dot.style.background = '#10b981';
                        if (text) text.textContent = 'Datos sincronizados';
                        break;
                    case 'error':
                        if (dot) dot.style.background = '#ef4444';
                        if (text) text.textContent = 'Error de sincronización';
                        break;
                }
            }

            showLoadingOverlay(show) {
                const overlay = document.getElementById('loadingOverlay');
                if (show) {
                    overlay?.classList.add('visible');
                } else {
                    overlay?.classList.remove('visible');
                }
            }
        }

        // ================================
        // INVENTORY MODULE MANAGEMENT
        // ================================

        class InventoryManager {
            constructor(systemManager) {
                this.systemManager = systemManager;
                this.products = [];
                this.editingProductId = null;
                this.deletingProductId = null;
                this.nextProductId = 1;
                this.initialize();
            }

            initialize() {
                this.loadProducts();
                this.setupEventListeners();
                this.updateDashboard();

                // Listen for system sync events
                window.addEventListener('ciervoSync', (event) => {
                    this.handleSyncEvent(event.detail);
                });
            }

            loadProducts() {
                this.products = this.systemManager.getData('inventory') || [];
                this.nextProductId = this.products.length > 0 ? Math.max(...this.products.map(p => p.id), 0) + 1 : 1;
                this.renderProducts();
            }

            handleSyncEvent(syncData) {
                if (syncData.store === 'inventory' && syncData.source !== 'inventario') {
                    // Update local products from system data
                    this.products = syncData.data;
                    this.renderProducts();
                    this.updateDashboard();
                }
            }

            setupEventListeners() {
                // Search functionality
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.addEventListener('input', () => this.filterProducts());
                }

                // Form calculations
                const costInput = document.getElementById('productCost');
                const marginInput = document.getElementById('productMargin');

                if (costInput) costInput.addEventListener('input', () => this.calculatePrice());
                if (marginInput) marginInput.addEventListener('input', () => this.calculatePrice());

                // Close modals on outside click
                const productModal = document.getElementById('productModal');
                const deleteModal = document.getElementById('deleteModal');

                if (productModal) {
                    productModal.addEventListener('click', (e) => {
                        if (e.target === productModal) this.closeModal();
                    });
                }

                if (deleteModal) {
                    deleteModal.addEventListener('click', (e) => {
                        if (e.target === deleteModal) this.closeDeleteModal();
                    });
                }
            }

            renderProducts() {
                const tbody = document.getElementById('inventoryTableBody');
                const emptyState = document.getElementById('emptyState');

                if (!tbody || !emptyState) return;

                if (this.products.length === 0) {
                    tbody.innerHTML = '';
                    emptyState.style.display = 'block';
                    return;
                }

                emptyState.style.display = 'none';

                tbody.innerHTML = this.products.map(product => {
                    const stockLevel = this.getStockLevel(product);
                    const stockBadgeClass = `stock-${stockLevel}`;

                    return `
                        <tr data-product-id="${product.id}">
                            <td>
                                <div class="product-info">
                                    <div class="product-image">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <rect width="20" height="14" x="2" y="3" rx="2"/>
                                            <line x1="8" y1="21" x2="16" y2="21"/>
                                            <line x1="12" y1="17" x2="12" y2="21"/>
                                        </svg>
                                    </div>
                                    <div class="product-details">
                                        <h4>${product.name}</h4>
                                        <p>${product.code || 'Sin código'}</p>
                                        ${product.description ? `<p style="font-size: 0.75rem; margin-top: 0.25rem;">${product.description.length > 50 ? product.description.substring(0, 50) + '...' : product.description}</p>` : ''}
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="stock-badge ${stockBadgeClass}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect width="7" height="7" x="3" y="3" rx="1"/>
                                        <rect width="7" height="7" x="14" y="3" rx="1"/>
                                        <rect width="7" height="7" x="14" y="14" rx="1"/>
                                        <rect width="7" height="7" x="3" y="14" rx="1"/>
                                    </svg>
                                    ${product.stock} unidades
                                </span>
                            </td>
                            <td class="price-cell">
                                <div class="price-main">${product.cost.toFixed(2)}</div>
                            </td>
                            <td class="margin-cell">
                                <div class="margin-value">${product.margin}%</div>
                            </td>
                            <td class="price-cell">
                                <div class="price-main">${product.price.toFixed(2)}</div>
                                <div class="price-cost">+${product.profit.toFixed(2)}</div>
                            </td>
                            <td>
                                <span style="font-weight: 500;">${product.brand || 'Sin marca'}</span>
                                ${product.category ? `<div style="font-size: 0.75rem; color: #64748b;">${product.category}</div>` : ''}
                            </td>
                            <td>
                                <div class="action-buttons-cell">
                                    <button class="btn-icon btn-edit" onclick="inventoryManager.editProduct(${product.id})" title="Editar">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                        </svg>
                                    </button>
                                    <button class="btn-icon btn-delete" onclick="inventoryManager.deleteProduct(${product.id})" title="Eliminar">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M3 6h18"/>
                                            <path d="M19 6v14c0 1-1 2-2 2H7c0-1-1-2-1-2V6"/>
                                            <path d="M8 6V4c0-1 1-2 2-2h4c0 1 1 2 1 2v2"/>
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');

                // Re-initialize icons
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }

            getStockLevel(product) {
                if (product.stock <= product.minStock) return 'low';
                if (product.stock <= product.minStock * 2) return 'medium';
                return 'high';
            }

            filterProducts() {
                const searchInput = document.getElementById('searchInput');
                if (!searchInput) return;

                const searchTerm = searchInput.value.toLowerCase();
                const rows = document.querySelectorAll('#inventoryTableBody tr');

                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            }

            openModal(mode, productId = null) {
                this.editingProductId = productId;
                const modal = document.getElementById('productModal');
                const title = document.getElementById('modalTitle');
                const saveButton = document.getElementById('saveButton');

                if (!modal) return;

                if (mode === 'add') {
                    if (title) title.textContent = 'Nuevo Producto';
                    if (saveButton) saveButton.textContent = 'Guardar Producto';
                    this.resetForm();
                } else {
                    const product = this.products.find(p => p.id === productId);
                    if (product) {
                        if (title) title.textContent = 'Editar Producto';
                        if (saveButton) saveButton.textContent = 'Actualizar Producto';
                        this.fillForm(product);
                    }
                }

                modal.classList.add('show');
            }

            closeModal() {
                const modal = document.getElementById('productModal');
                if (modal) {
                    modal.classList.remove('show');
                    this.editingProductId = null;
                    this.resetForm();
                }
            }

            resetForm() {
                const form = document.getElementById('productForm');
                if (form) {
                    form.reset();
                    const priceField = document.getElementById('productPrice');
                    const profitField = document.getElementById('productProfit');
                    if (priceField) priceField.value = '';
                    if (profitField) profitField.value = '';
                }
            }

            fillForm(product) {
                const fields = {
                    productName: product.name,
                    productCode: product.code || '',
                    productDescription: product.description || '',
                    productBrand: product.brand || '',
                    productCategory: product.category || '',
                    productStock: product.stock,
                    productMinStock: product.minStock,
                    productCost: product.cost,
                    productMargin: product.margin,
                    productPrice: product.price.toFixed(2),
                    productProfit: product.profit.toFixed(2)
                };

                Object.entries(fields).forEach(([fieldId, value]) => {
                    const field = document.getElementById(fieldId);
                    if (field) field.value = value;
                });
            }

            calculatePrice() {
                const costInput = document.getElementById('productCost');
                const marginInput = document.getElementById('productMargin');
                const priceInput = document.getElementById('productPrice');
                const profitInput = document.getElementById('productProfit');

                if (!costInput || !marginInput || !priceInput || !profitInput) return;

                const cost = parseFloat(costInput.value) || 0;
                const margin = parseFloat(marginInput.value) || 0;

                const price = cost * (1 + margin / 100);
                const profit = price - cost;

                priceInput.value = price.toFixed(2);
                profitInput.value = profit.toFixed(2);
            }

            saveProduct() {
                const form = document.getElementById('productForm');
                if (!form || !form.checkValidity()) {
                    form?.reportValidity();
                    return;
                }

                const productData = {
                    name: document.getElementById('productName')?.value || '',
                    code: document.getElementById('productCode')?.value || '',
                    description: document.getElementById('productDescription')?.value || '',
                    brand: document.getElementById('productBrand')?.value || '',
                    category: document.getElementById('productCategory')?.value || '',
                    stock: parseInt(document.getElementById('productStock')?.value || '0'),
                    minStock: parseInt(document.getElementById('productMinStock')?.value || '0'),
                    cost: parseFloat(document.getElementById('productCost')?.value || '0'),
                    margin: parseFloat(document.getElementById('productMargin')?.value || '0'),
                    price: parseFloat(document.getElementById('productPrice')?.value || '0'),
                    profit: parseFloat(document.getElementById('productProfit')?.value || '0')
                };

                let updatedProducts;

                if (this.editingProductId) {
                    // Update existing product
                    updatedProducts = this.products.map(p =>
                        p.id === this.editingProductId
                            ? { ...p, ...productData }
                            : p
                    );
                } else {
                    // Add new product
                    productData.id = this.nextProductId++;
                    updatedProducts = [...this.products, productData];
                }

                // Update through system manager for sync
                this.systemManager.updateData('inventory', () => updatedProducts);

                this.products = updatedProducts;
                this.renderProducts();
                this.updateDashboard();
                this.closeModal();

                // Show success message
                const action = this.editingProductId ? 'actualizado' : 'agregado';
                this.showNotification(`Producto ${action} exitosamente`, 'success');
            }

            editProduct(productId) {
                this.openModal('edit', productId);
            }

            deleteProduct(productId) {
                this.deletingProductId = productId;
                const modal = document.getElementById('deleteModal');
                if (modal) modal.classList.add('show');
            }

            closeDeleteModal() {
                const modal = document.getElementById('deleteModal');
                if (modal) {
                    modal.classList.remove('show');
                    this.deletingProductId = null;
                }
            }

            confirmDelete() {
                if (this.deletingProductId) {
                    const updatedProducts = this.products.filter(p => p.id !== this.deletingProductId);

                    // Update through system manager for sync
                    this.systemManager.updateData('inventory', () => updatedProducts);

                    this.products = updatedProducts;
                    this.renderProducts();
                    this.updateDashboard();
                    this.closeDeleteModal();
                    this.showNotification('Producto eliminado exitosamente', 'success');
                }
            }

            updateDashboard() {
                const totalProducts = this.products.length;
                const totalStock = this.products.reduce((sum, p) => sum + p.stock, 0);
                const totalValue = this.products.reduce((sum, p) => sum + (p.price * p.stock), 0);
                const lowStock = this.products.filter(p => p.stock <= p.minStock).length;

                const elements = {
                    totalProducts: document.getElementById('totalProducts'),
                    totalStock: document.getElementById('totalStock'),
                    totalValue: document.getElementById('totalValue'),
                    lowStock: document.getElementById('lowStock')
                };

                if (elements.totalProducts) elements.totalProducts.textContent = totalProducts;
                if (elements.totalStock) elements.totalStock.textContent = totalStock.toLocaleString();
                if (elements.totalValue) elements.totalValue.textContent = `${totalValue.toLocaleString()}`;
                if (elements.lowStock) elements.lowStock.textContent = lowStock;
            }

            exportInventory() {
                if (this.products.length === 0) {
                    this.showNotification('No hay productos para exportar', 'info');
                    return;
                }

                const data = this.products.map(p => ({
                    Nombre: p.name,
                    Código: p.code || '',
                    Descripción: p.description || '',
                    Marca: p.brand || '',
                    Categoría: p.category || '',
                    Stock: p.stock,
                    'Stock Mínimo': p.minStock,
                    'Precio Costo': p.cost,
                    'Margen (%)': p.margin,
                    'Precio Venta': p.price,
                    'Ganancia': p.profit
                }));

                const csv = this.convertToCSV(data);
                this.downloadCSV(csv, 'inventario_ciervo.csv');
            }

            convertToCSV(data) {
                const headers = Object.keys(data[0]).join(',');
                const rows = data.map(row => Object.values(row).join(',')).join('\n');
                return headers + '\n' + rows;
            }

            downloadCSV(csv, filename) {
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }

            showNotification(message, type = 'info') {
                // Simple alert for now - could be enhanced with a toast notification system
                alert(message);
            }
        }

        // ================================
        // GLOBAL FUNCTIONS & INITIALIZATION
        // ================================

        // Initialize global system manager
        let systemManager;
        let inventoryManager;

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize system manager
            systemManager = new CiervoSystemManager();

            // Initialize inventory manager
            inventoryManager = new InventoryManager(systemManager);

            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // Close notification panel when clicking outside
            document.addEventListener('click', function(event) {
                const notificationButton = document.querySelector('.icon-button.notification');
                const notificationPanel = document.getElementById('notificationPanel');
                if (notificationPanel && notificationButton && !notificationButton.contains(event.target) && !notificationPanel.contains(event.target)) {
                    notificationPanel.classList.remove('show');
                }
            });

            // --- Consolidated currentUser check and UI update ---
            const userDataString = sessionStorage.getItem('currentUser');
            
            if (userDataString) {
                try {
                    const userData = JSON.parse(userDataString);
                    
                    const userNameElement = document.getElementById('user-name');
                    const userRoleElement = document.getElementById('user-role');
                    
                    if (userNameElement) {
                        // Usamos el nombre y apellido del operador
                        userNameElement.textContent = `${userData.firstName} ${userData.lastName}`;
                    }
                    
                    if (userRoleElement) {
                        // Usamos el rol del operador
                        userRoleElement.textContent = userData.role;
                    }

                    // Aquí también se debe llamar a la función para aplicar permisos según el rol
                    if (window.systemManager) {
                        systemManager.applyRoleBasedAccess();
                    }

                } catch (error) {
                    console.error("Error al procesar los datos del usuario:", error);
                    // Si hay un error, lo mandamos de vuelta al login
                    window.location.href = 'index.html';
                }
            } else {
                // Si no hay datos de sesión, no debería estar aquí. Lo redirigimos al login.
                alert("No se ha iniciado sesión. Redirigiendo al login.");
                window.location.href = 'index.html';
            }
            // --- End of consolidated currentUser check ---
        });

        // Navigation Functions
        function navigateToModule(moduleId) {
            if (systemManager) {
                systemManager.eventBus.dispatchEvent(new CustomEvent('moduleChange', {
                    detail: {
                        from: systemManager.currentModule,
                        to: moduleId
                    }
                }));
            }
        }

        // Function to navigate to accounts.html with a specific account ID
        function navigateToAccountDetail(accountId, accountType) {
            // You might want to pass the accountId and type as URL parameters
            // For example: cuentas.html?id=123&type=cobrar
            window.location.href = `cuentas.html?id=${accountId}&type=${accountType}`;
        }

        // Modal Functions (exposed globally)
        function openModal(mode, productId = null) {
            if (inventoryManager) {
                inventoryManager.openModal(mode, productId);
            }
        }

        function closeModal() {
            if (inventoryManager) {
                inventoryManager.closeModal();
            }
        }

        function closeDeleteModal() {
            if (inventoryManager) {
                inventoryManager.closeDeleteModal();
            }
        }

        function saveProduct() {
            if (inventoryManager) {
                inventoryManager.saveProduct();
            }
        }

        function confirmDelete() {
            if (inventoryManager) {
                inventoryManager.confirmDelete();
            }
        }

        function exportInventory() {
            if (inventoryManager) {
                inventoryManager.exportInventory();
            }
        }

        // Action Functions
        function executeAction(action) {
            switch (action) {
                case 'openCatalog':
                    alert('Iniciando Catálogo Digital');
                    break;
                case 'openTools':
                    alert('Abriendo Herramientas');
                    break;
                case 'openTasa':
                    const userSettings = systemManager?.getData('userSettings');
                    if (userSettings?.role === 'Vendedor') {
                        alert('Acceso denegado. Solo administradores pueden acceder a Cotizaciones en Tiempo Real.');
                        return;
                    }
                    alert('Accediendo a Cotizaciones en Tiempo Real');
                    break;
                default:
                    console.log(`Ejecutando acción: ${action}`);
            }
        }

        // User Management
        function toggleNotifications() {
            const notificationPanel = document.getElementById('notificationPanel');
            if (notificationPanel) {
                notificationPanel.classList.toggle('show');
                // Update notifications every time the panel is opened
                systemManager.updateNotifications();
            }
        }

        // Función para mostrar el modal de cierre de sesión
        function handleLogout() {
            // Mostrar el modal personalizado
            document.getElementById('logoutModal').classList.add('show');
        }

        // Función para cerrar el modal
        function closeLogoutModal() {
            document.getElementById('logoutModal').classList.remove('show');
        }

        // Función para confirmar el cierre de sesión
        function confirmLogout() {
            // Limpiar datos de sesión
            localStorage.removeItem('authToken');
            sessionStorage.clear();

            // Cerrar el modal
            closeLogoutModal();

            // Redirigir al index.html
            window.location.href = 'index.html';
        }

        // Cerrar modal al hacer clic fuera del contenido
        document.getElementById('logoutModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLogoutModal();
            }
        });

        // Cerrar modal con la tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeLogoutModal();
            }
        });

        // Funciones para controlar el modal de operaciones
        function openOperationsModal() {
            document.getElementById('operationsModal').classList.add('active');
            // Re-apply role-based access control when modal opens
            systemManager.applyRoleBasedAccess();
        }

        function closeOperationsModal() {
            document.getElementById('operationsModal').classList.remove('active');
        }

        // Cerrar modal al hacer clic fuera del contenido
        document.getElementById('operationsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeOperationsModal();
            }
        });

        // Cerrar modal con la tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeOperationsModal();
            }
        });

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const sunIcon = document.querySelector('.sun-icon');
            const moonIcon = document.querySelector('.moon-icon');

            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'inline-block';
            } else {
                localStorage.setItem('darkMode', 'disabled');
                sunIcon.style.display = 'inline-block';
                moonIcon.style.display = 'none';
            }
        }

        // Apply dark mode on load based on localStorage
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
                const sunIcon = document.querySelector('.sun-icon');
                const moonIcon = document.querySelector('.moon-icon');
                if (sunIcon) sunIcon.style.display = 'none';
                if (moonIcon) moonIcon.style.display = 'inline-block';
            }
        });
    </script>
</body>
</html>
